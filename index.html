<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ESP32 Relay Control Dashboard</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

  <!--<script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://kit.fontawesome.com/your_kit_code.js" crossorigin="anonymous"></script>-->

  <script>
  tailwind.config = {
    darkMode: 'class', // Ajout ici
    theme: {
      extend: {
        colors: {
          'primary': '#1e40af',
          'secondary': '#3b82f6',
          'success': '#10b981',
          'danger': '#ef4444',
          'warning': '#f59e0b',
          'dark': '#1e293b',
        }
      }
    }
  }
</script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #f0f9ff 0%, hwb(204 88% 0%) 100%);
      min-height: 100vh;
    }
    
    .relay-card {
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .relay-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1), 0 4px 6px rgba(0, 0, 0, 0.05);
    }
    
    .status-indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 8px;
    }
    
    .status-on {
       background-color: #64748b;
     
    }
    
    .status-off {
      background-color: #10b981;
      box-shadow: 0 0 8px rgba(16, 185, 129, 0.6);
    }
    
    .toggle-btn {
      transition: all 0.2s ease;
    }
    
    .toggle-btn:active {
      transform: scale(0.95);
    }
    
    .login-card {
      animation: fadeIn 0.5s ease-out;
    }
    
 

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .power-icon {
      transition: all 0.3s ease;
    }
    
    .relay-on .power-icon {
      color: #10b981;
      transform: scale(1.1);
    }
  </style>
</head>
<body id="body" class="bg-gray-50 dark:bg-dark py-8 text-gray-800 dark:text-gray-100 transition-colors duration-300">


  <div class="container mx-auto px-4">

    <!-- Header -->
    <div class="text-center mb-10">
      <div class="flex justify-center items-center mb-4">
        <div class="bg-blue-100 p-3 rounded-full mr-4">
          <i class="fas fa-microchip text-blue-600 text-3xl"></i>
        </div>
        <h1 class="text-3xl md:text-4xl font-bold text-gray-800">Dashboard</h1>
      </div>
      <p class="text-gray-600 max-w-2xl mx-auto">
        Controled your home
      </p>
    </div>
   
    
    <!-- Bouton en haut à droite -->
<div style="position: fixed; top: 20px; right: 20px; z-index: 1000;">
  <button id="toggleTheme" class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-2 px-4 rounded-lg transition flex items-center">
    <i class="fas fa-adjust mr-2"></i> Thème
  </button>
</div>

<!-- Panneau de sélection de couleur -->
<div id="themePanel" class="hidden fixed top-24 right-6 bg-white p-6 rounded-lg shadow-lg border z-50" style="min-width: 200px;">
  <h2 class="text-lg font-semibold mb-2">Choisir la couleur du fond</h2>
  <input type="color" id="colorPicker" class="w-full h-10 mb-4 cursor-pointer">
  <button id="applyTheme" class="bg-blue-500 hover:bg-blue-600 text-white py-1 px-3 rounded">Appliquer</button>
</div>





    
    <!-- Login Form -->
    <div id="loginForm" class="login-card bg-white rounded-2xl shadow-xl p-8 max-w-md mx-auto">
      <div class="text-center mb-8">
        <div class="bg-blue-100 p-4 rounded-full inline-block mb-4">
          <i class="fas fa-lock text-blue-600 text-3xl"></i>
        </div>
        <h2 class="text-2xl font-bold text-gray-800">Secure Login</h2>
        <p class="text-gray-600 mt-2">Enter your credentials to access the relay controls</p>
      </div>
      
      <div class="space-y-4">
        <div>
          <label class="block text-gray-700 font-medium mb-2" for="email">Email</label>
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i class="fas fa-envelope text-gray-400"></i>
            </div>
            <input 
              type="email" 
              id="email" 
              placeholder="Enter your email" 
              class="w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"
              value="abc@gmail.com"
            >
          </div>
        </div>
        
        <div>
          <label class="block text-gray-700 font-medium mb-2" for="password">Password</label>
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i class="fas fa-lock text-gray-400"></i>
            </div>
            <input 
              type="password" 
              id="password" 
              placeholder="Enter your password" 
              class="w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"
              value="90009550"
            >
          </div>
        </div>
        
        <button id="loginBtn" class="w-full bg-primary hover:bg-blue-800 text-white font-semibold py-3 px-4 rounded-lg transition duration-300 transform hover:scale-[1.02] mt-6">
          <i class="fas fa-sign-in-alt mr-2"></i> Login to Dashboard
        </button>
      </div>
    </div>



   

    
    <!-- Dashboard -->
    <div id="dashboard" class="hidden">
      <!-- Controls Header -->
      <div class="bg-white rounded-2xl shadow-md p-6 mb-8 flex flex-col md:flex-row justify-between items-center">
        <div class="flex items-center mb-4 md:mb-0">
          <div class="bg-blue-100 p-3 rounded-full mr-4">
            <i class="fas fa-sliders-h text-blue-600 text-xl"></i>
          </div>
          <h2 class="text-2xl font-bold text-gray-800">Relay Controls</h2>
        </div>
        
        <div class="flex flex-wrap gap-3">
          <button id="allOnBtn" class="bg-success hover:bg-green-600 text-white font-medium py-2 px-4 rounded-lg transition flex items-center">
            <i class="fas fa-power-off mr-2"></i> All ON
          </button>
          <button id="allOffBtn" class="bg-danger hover:bg-red-600 text-white font-medium py-2 px-4 rounded-lg transition flex items-center">
            <i class="fas fa-power-off mr-2"></i> All OFF
          </button>
          <button id="logoutBtn" class="bg-gray-700 hover:bg-gray-800 text-white font-medium py-2 px-4 rounded-lg transition flex items-center">
            <i class="fas fa-sign-out-alt mr-2"></i> Logout
          </button>
        </div>
      </div>
      
      <!-- Relay Grid -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
        <!-- Relay 1 -->
        <div class="relay-card bg-white rounded-xl p-6">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h3 class="text-xl font-semibold text-gray-800">Relay 1</h3>
              <div class="flex items-center mt-1">
                <span class="status-indicator status-off" id="indicator1"></span>
                <span class="text-gray-600" id="status1">OFF</span>
              </div>
            </div>
            <div class="bg-blue-100 p-2 rounded-lg">
              <i class="fas fa-lightbulb text-blue-600 text-xl"></i>
            </div>
          </div>
          <button id="btn1" class="toggle-btn w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-3 rounded-lg transition flex items-center justify-center">
            <i class="fas fa-power-off power-icon mr-2"></i> Toggle Relay
          </button>
        </div>
        
        <!-- Relay 2 -->
        <div class="relay-card bg-white rounded-xl p-6">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h3 class="text-xl font-semibold text-gray-800">Relay 2</h3>
              <div class="flex items-center mt-1">
                <span class="status-indicator status-off" id="indicator2"></span>
                <span class="text-gray-600" id="status2">OFF</span>
              </div>
            </div>
            <div class="bg-blue-100 p-2 rounded-lg">
              <i class="fas fa-lightbulb text-blue-600 text-xl"></i>
            </div>
          </div>
          <button id="btn2" class="toggle-btn w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-3 rounded-lg transition flex items-center justify-center">
            <i class="fas fa-power-off power-icon mr-2"></i> Toggle Relay
          </button>
        </div>
        
        <!-- Relay 3 -->
        <div class="relay-card bg-white rounded-xl p-6">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h3 class="text-xl font-semibold text-gray-800">Relay 3</h3>
              <div class="flex items-center mt-1">
                <span class="status-indicator status-off" id="indicator3"></span>
                <span class="text-gray-600" id="status3">OFF</span>
              </div>
            </div>
            <div class="bg-blue-100 p-2 rounded-lg">
              <i class="fas fa-lightbulb text-blue-600 text-xl"></i>
            </div>
          </div>
          <button id="btn3" class="toggle-btn w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-3 rounded-lg transition flex items-center justify-center">
            <i class="fas fa-power-off power-icon mr-2"></i> Toggle Relay
          </button>
        </div>
        
        <!-- Relay 4 -->
        <div class="relay-card bg-white rounded-xl p-6">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h3 class="text-xl font-semibold text-gray-800">Relay 4</h3>
              <div class="flex items-center mt-1">
                <span class="status-indicator status-off" id="indicator4"></span>
                <span class="text-gray-600" id="status4">OFF</span>
              </div>
            </div>
            <div class="bg-blue-100 p-2 rounded-lg">
              <i class="fas fa-lightbulb text-blue-600 text-xl"></i>
            </div>
          </div>
          <button id="btn4" class="toggle-btn w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-3 rounded-lg transition flex items-center justify-center">
            <i class="fas fa-power-off power-icon mr-2"></i> Toggle Relay
          </button>
        </div>
        
        <!-- Relay 5 -->
        <div class="relay-card bg-white rounded-xl p-6">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h3 class="text-xl font-semibold text-gray-800">Relay 5</h3>
              <div class="flex items-center mt-1">
                <span class="status-indicator status-off" id="indicator5"></span>
                <span class="text-gray-600" id="status5">OFF</span>
              </div>
            </div>
            <div class="bg-blue-100 p-2 rounded-lg">
              <i class="fas fa-lightbulb text-blue-600 text-xl"></i>
            </div>
          </div>
          <button id="btn5" class="toggle-btn w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-3 rounded-lg transition flex items-center justify-center">
            <i class="fas fa-power-off power-icon mr-2"></i> Toggle Relay
          </button>
        </div>
        
        <!-- Relay 6 -->
        <div class="relay-card bg-white rounded-xl p-6">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h3 class="text-xl font-semibold text-gray-800">Relay 6</h3>
              <div class="flex items-center mt-1">
                <span class="status-indicator status-off" id="indicator6"></span>
                <span class="text-gray-600" id="status6">OFF</span>
              </div>
            </div>
            <div class="bg-blue-100 p-2 rounded-lg">
              <i class="fas fa-lightbulb text-blue-600 text-xl"></i>
            </div>
          </div>
          <button id="btn6" class="toggle-btn w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-3 rounded-lg transition flex items-center justify-center">
            <i class="fas fa-power-off power-icon mr-2"></i> Toggle Relay
          </button>
        </div>
        
        <!-- Relay 7 -->
        <div class="relay-card bg-white rounded-xl p-6">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h3 class="text-xl font-semibold text-gray-800">Relay 7</h3>
              <div class="flex items-center mt-1">
                <span class="status-indicator status-off" id="indicator7"></span>
                <span class="text-gray-600" id="status7">OFF</span>
              </div>
            </div>
            <div class="bg-blue-100 p-2 rounded-lg">
              <i class="fas fa-lightbulb text-blue-600 text-xl"></i>
            </div>
          </div>
          <button id="btn7" class="toggle-btn w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-3 rounded-lg transition flex items-center justify-center">
            <i class="fas fa-power-off power-icon mr-2"></i> Toggle Relay
          </button>
        </div>
        
        <!-- Relay 8 -->
        <div class="relay-card bg-white rounded-xl p-6">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h3 class="text-xl font-semibold text-gray-800">Relay 8</h3>
              <div class="flex items-center mt-1">
                <span class="status-indicator status-off" id="indicator8"></span>
                <span class="text-gray-600" id="status8">OFF</span>
              </div>
            </div>
            <div class="bg-blue-100 p-2 rounded-lg">
              <i class="fas fa-lightbulb text-blue-600 text-xl"></i>
            </div>
          </div>
          <button id="btn8" class="toggle-btn w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-3 rounded-lg transition flex items-center justify-center">
            <i class="fas fa-power-off power-icon mr-2"></i> Toggle Relay
          </button>
        </div>
      </div>
      
      <!-- System Status -->
      <div class="bg-white rounded-2xl shadow-md p-6">
        <div class="flex items-center mb-4">
          <div class="bg-blue-100 p-3 rounded-full mr-4">
            <i class="fas fa-heartbeat text-blue-600 text-xl"></i>
          </div>
          <h2 class="text-2xl font-bold text-gray-800">System Status</h2>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="bg-blue-50 rounded-xl p-5">
            <div class="flex items-center">
              <div class="bg-blue-100 p-3 rounded-lg mr-4">
                <i class="fas fa-microchip text-blue-600 text-xl"></i>
              </div>
              <div>
                <p class="text-gray-600">Controller</p>
                <p class="text-lg font-semibold">ESP32</p>
              </div>
            </div>
          </div>
          
          <div class="bg-green-50 rounded-xl p-5">
            <div class="flex items-center">
              <div class="bg-green-100 p-3 rounded-lg mr-4">
                <i class="fas fa-plug text-green-600 text-xl"></i>
              </div>
              <div>
                <p class="text-gray-600">Relays Actif</p>
                <p class="text-lg font-semibold"><span id="activeRelays">0</span>/8</p>
              </div>
            </div>
          </div>
          
          <div class="bg-purple-50 rounded-xl p-5">
            <div class="flex items-center">
              <div class="bg-purple-100 p-3 rounded-lg mr-4">
                <i class="fas fa-network-wired text-purple-600 text-xl"></i>
              </div>
              <div>
                <p class="text-gray-600">Connection</p>
                <p class="text-lg font-semibold text-green-600">Online</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Footer -->
    <footer class="mt-12 text-center text-gray-600">
      <div class="flex justify-center space-x-6 mb-4">
        <a href="#" class="text-gray-500 hover:text-primary transition">
          <i class="fab fa-github text-xl"></i>
        </a>
        <a href="#" class="text-gray-500 hover:text-primary transition">
          <i class="fab fa-youtube text-xl"></i>
        </a>
        <a href="#" class="text-gray-500 hover:text-primary transition">
          <i class="fab fa-twitter text-xl"></i>
        </a>
      </div>
      <p>Created by <span class="font-semibold text-primary">POWERTEC</span> | SMART HOME</p>
    </footer>
  </div>
  
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
  
  <script>
    // Firebase config
   // Firebase config
    const firebaseConfig = {
    apiKey: "AIzaSyB1Dfgal-Lp5fs5ClMMMhlDTGxzMxS4f5E",
    authDomain: "proacademia-134e6.firebaseapp.com",
    databaseURL: "https://proacademia-134e6-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "proacademia-134e6",
    storageBucket: "proacademia-134e6.firebasestorage.app",
    messagingSenderId: "753251437128",
    appId: "1:753251437128:web:88b88844e0ed2e8125a67d",
    measurementId: "G-KGRHW9L9C9"
};

    firebase.initializeApp(firebaseConfig);


  //theme
  const toggleThemeBtn = document.getElementById("toggleTheme");
  const themePanel = document.getElementById("themePanel");
  const colorPicker = document.getElementById("colorPicker");
  const applyThemeBtn = document.getElementById("applyTheme");

  // Ouvrir/fermer le panneau de thème
  toggleThemeBtn.addEventListener("click", () => {
    themePanel.classList.toggle("hidden");
  });

  // Appliquer la couleur choisie
  applyThemeBtn.addEventListener("click", () => {
    const color = colorPicker.value;
    document.body.style.background = color;
    localStorage.setItem("customBackground", color);
    themePanel.classList.add("hidden");
  });

  // Charger couleur si sauvegardée
  window.addEventListener("DOMContentLoaded", () => {
    const saved = localStorage.getItem("customBackground");
    if (saved) {
      document.body.style.background = saved;
      colorPicker.value = saved;
    }
  });





    // Predefined login credentials
    const allowedEmail = "rommygerard3@gmail.com";
    const allowedPassword = "Rommy0";

    const loginForm = document.getElementById("loginForm");
    const dashboard = document.getElementById("dashboard");
    const loginBtn = document.getElementById("loginBtn");
    const logoutBtn = document.getElementById("logoutBtn");
    const allOnBtn = document.getElementById("allOnBtn");
    const allOffBtn = document.getElementById("allOffBtn");

    loginBtn.addEventListener("click", () => {
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value;

      if (!email || !password) {
        alert("Please enter email and password.");
        return;
      }

      // Check hardcoded credentials first
      if(email === allowedEmail && password === allowedPassword){
        // Sign in with Firebase
        firebase.auth().signInWithEmailAndPassword(email, password)
          .then(userCredential => {
            console.log("Signed in as", userCredential.user.email);
            loginForm.classList.add("hidden");
            dashboard.classList.remove("hidden");
            startRelayControl();
          })
          .catch(error => {
            alert("Firebase login failed: " + error.message);
          });
      } else {
        alert("Invalid email or password.");
      }
    });

    function startRelayControl() {
      const db = firebase.database();

      const relays = [
        { id: 1, path: "relay1" },
        { id: 2, path: "relay2" },
        { id: 3, path: "relay3" },
        { id: 4, path: "relay4" },
        { id: 5, path: "relay5" },
        { id: 6, path: "relay6" },
        { id: 7, path: "relay7" },
        { id: 8, path: "relay8" }
      ];

      relays.forEach(relay => {
       const statusText = document.getElementById(`status${relay.id}`);
      const indicator = document.getElementById(`indicator${relay.id}`);
      const toggleButton = document.getElementById(`btn${relay.id}`);
      const relayRef = db.ref("/" + relay.path);


        relayRef.on("value", (snapshot) => {
          const state = snapshot.val();
          statusText.innerText = state ? "ON" : "OFF";
          
          if (state) {
            statusText.classList.remove("text-gray-600");
            statusText.classList.add("text-green-600");
            indicator.classList.remove("status-on");
            indicator.classList.add("status-off");
            toggleButton.classList.remove("bg-gray-200", "hover:bg-gray-300", "text-gray-800");
            toggleButton.classList.add("bg-green-100", "hover:bg-green-200", "text-green-800");
            toggleButton.parentElement.classList.add("relay-on");
          } else {
            statusText.classList.remove("text-green-600");
            statusText.classList.add("text-gray-600");
            indicator.classList.remove("status-off");
            indicator.classList.add("status-on");
            toggleButton.classList.remove("bg-green-100", "hover:bg-green-200", "text-green-800");
            toggleButton.classList.add("bg-gray-200", "hover:bg-gray-300", "text-gray-800");
            toggleButton.parentElement.classList.remove("relay-on");
          }
          
          // Update active relays count
          updateActiveRelays();
        });

        toggleButton.onclick = () => {
          relayRef.get().then(snap => {
            relayRef.set(!snap.val());
          });
        };
      });

      function updateActiveRelays() {
  let activeCount = 0;
  relays.forEach(relay => {
    const statusText = document.getElementById(`status${relay.id}`);
    if (statusText.innerText === "ON") activeCount++;
  });
  document.getElementById("activeRelays").innerText = activeCount;
}


      allOnBtn.onclick = () => {
        relays.forEach(relay => {
          db.ref("/" + relay.path).set(true);
        });
      };

      allOffBtn.onclick = () => {
        relays.forEach(relay => {
          db.ref("/" + relay.path).set(false);
        });
      };
    }

    logoutBtn.onclick = () => {
      firebase.auth().signOut()
        .then(() => {
          dashboard.classList.add("hidden");
          loginForm.classList.remove("hidden");
          document.getElementById("email").value = "";
          document.getElementById("password").value = "";
        })
        .catch(error => {
          alert("Logout failed: " + error.message);
        });
    };

     if (localStorage.getItem("theme") === "dark" || (!("theme" in localStorage) && window.matchMedia("(prefers-color-scheme: dark)").matches)) {
    document.documentElement.classList.add("dark");
  } else {
    document.documentElement.classList.remove("dark");
  }
  </script>
</body>
</html>
